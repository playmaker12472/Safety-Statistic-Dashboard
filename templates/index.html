<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Safety Statistics</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="board">
        <h2 class="title">SAFETY STATISTICS</h2>
        <div class="stats">
            <div class="stat-item">DATE: <span id="date-time">Loading...</span> Days</div>
            <div class="stat-item">ZERO ACD TARGET: <span id="zero-lta">Loading...</span> Days</div>
            <div class="stat-item">PAST BEST RECORD: <span id="past-best">Loading...</span> Days</div>
            <div class="stat-item">CURRENT RECORD: <span id="current-record">Loading...</span> Days</div>
            <div class="stat-item">LAST ACCIDENT: <span id="last-accident">Loading...</span></div>
        </div>
        <button id="accident-btn" onclick="reportAccident()">ðŸš¨ Report Accident</button>
    </div>

    <script>
        function updateClock() {
            fetch('/time')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('date-time').innerText = data.time;
                });
        }

        function updateStats() {
            fetch('/stats')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('zero-lta').innerText = data.zero_lta_target;
                    document.getElementById('past-best').innerText = data.past_best_record;
                    document.getElementById('current-record').innerText = data.current_record;
                    document.getElementById('last-accident').innerText = data.last_accident;
                });
        }

        function reportAccident() {
            fetch('/reset', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    document.getElementById('current-record').innerText = 0;
                    document.getElementById('last-accident').innerText = data.last_accident;
                    document.getElementById('past-best').innerText = data.past_best_record;
                    alert("ðŸš¨ Accident recorded! Current record reset.");
                });
        }

        setInterval(updateClock, 1000);
        setInterval(updateStats, 5000);
        updateClock();
        updateStats();
    </script>
</body>
</html>
